{"version":3,"file":"WeatherClock.js","sources":["../../src/components/WeatherClock.js"],"sourcesContent":["// src/components/WeatherClock.js\nimport { LitElement, html } from 'https://unpkg.com/lit-element@2.4.0/lit-element.js?module';\nimport { weatherClockStyles } from '../styles/WeatherClockStyles';\nimport { sharedStyles } from '../styles/SharedStyles';\n\nexport class WeatherClock extends LitElement {\n  static get properties() {\n    return {\n      hass: { type: Object },\n      date: { type: String },\n      time: { type: String },\n      temperature: { type: String },\n      weatherIcon: { type: String },\n      aqi: { type: String },\n    };\n  }\n\n  static get styles() {\n    return [weatherClockStyles, sharedStyles];\n  }\n\n  constructor() {\n    super();\n    this.resetProperties();\n    this.updateTimer = null;\n  }\n\n  resetProperties() {\n    this.date = '';\n    this.time = '';\n    this.temperature = '';\n    this.weatherIcon = '';\n    this.aqi = '';\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.updateWeather();\n    this.scheduleUpdate();\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    if (this.updateTimer) {\n      clearTimeout(this.updateTimer);\n    }\n  }\n\n  scheduleUpdate() {\n    const now = new Date();\n    const delay = (60 - now.getSeconds()) * 1000 - now.getMilliseconds();\n    this.updateTimer = setTimeout(() => {\n      this.updateWeather();\n      this.scheduleUpdate();\n    }, delay);\n  }\n\n  updateWeather() {\n    const now = new Date();\n    this.updateDateTime(now);\n    this.updateWeatherData();\n    this.requestUpdate();\n  }\n\n  updateDateTime(now) {\n    this.date = now.toLocaleDateString('en-US', {\n      weekday: 'short',\n      month: 'short',\n      day: 'numeric',\n    });\n\n    this.time = now\n      .toLocaleTimeString('en-US', {\n        hour: 'numeric',\n        minute: '2-digit',\n        hour12: true,\n      })\n      .replace(/\\s?[AP]M/, '');\n  }\n\n  updateWeatherData() {\n    if (!this.hass) return;\n\n    const weatherEntity = this.hass.states['weather.64_west_glen_ave'];\n    const aqiEntity = this.hass.states['sensor.ridgewood_air_quality_index'];\n\n    if (weatherEntity) {\n      this.temperature = `${Math.round(weatherEntity.attributes.temperature)}Â°`;\n      this.weatherIcon = this.getWeatherIcon(weatherEntity.state);\n    }\n\n    if (aqiEntity) {\n      this.aqi = aqiEntity.state;\n    }\n  }\n\n  getWeatherIcon(state) {\n    const iconMapping = {\n      'clear-night': 'clear-night',\n      cloudy: 'cloudy-fill',\n      fog: 'fog',\n      hail: 'hail',\n      lightning: 'thunderstorms',\n      'lightning-rainy': 'thunderstorms-rain',\n      partlycloudy: 'partly-cloudy-day',\n      pouring: 'rain',\n      rainy: 'drizzle',\n      snowy: 'snow',\n      'snowy-rainy': 'sleet',\n      sunny: 'clear-day',\n      windy: 'wind',\n      'windy-variant': 'wind',\n      exceptional: 'not-available',\n    };\n    return iconMapping[state] || 'not-available-fill';\n  }\n\n  getAqiColor(aqi) {\n    if (aqi <= 50) return '#68a03a';\n    if (aqi <= 100) return '#f9bf33';\n    if (aqi <= 150) return '#f47c06';\n    if (aqi <= 200) return '#c43828';\n    if (aqi <= 300) return '#ab1457';\n    return '#83104c';\n  }\n\n  render() {\n    return html`\n      <link\n        href=\"https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;600&display=swap\"\n        rel=\"stylesheet\"\n      />\n      <div class=\"weather-component\">\n        <div class=\"left-column\">\n          <div class=\"date\">${this.date}</div>\n          <div class=\"time\">${this.time}</div>\n        </div>\n        <div class=\"right-column\">\n          <div class=\"weather-info\">\n            <img\n              src=\"https://basmilius.github.io/weather-icons/production/fill/all/${this\n                .weatherIcon}.svg\"\n              class=\"weather-icon\"\n              alt=\"Weather icon\"\n            />\n            <span class=\"temperature\">${this.temperature}</span>\n          </div>\n          <div class=\"aqi\" style=\"background-color: ${this.getAqiColor(parseInt(this.aqi))}\">\n            ${this.aqi} AQI\n          </div>\n        </div>\n      </div>\n    `;\n  }\n}\n\ncustomElements.define('weather-clock', WeatherClock);\n"],"names":["WeatherClock","LitElement","properties","hass","type","Object","date","String","time","temperature","weatherIcon","aqi","styles","weatherClockStyles","sharedStyles","constructor","super","this","resetProperties","updateTimer","connectedCallback","updateWeather","scheduleUpdate","disconnectedCallback","clearTimeout","now","Date","delay","getSeconds","getMilliseconds","setTimeout","updateDateTime","updateWeatherData","requestUpdate","toLocaleDateString","weekday","month","day","toLocaleTimeString","hour","minute","hour12","replace","weatherEntity","states","aqiEntity","Math","round","attributes","getWeatherIcon","state","cloudy","fog","hail","lightning","partlycloudy","pouring","rainy","snowy","sunny","windy","exceptional","getAqiColor","render","html","parseInt","customElements","define"],"mappings":";;;;;;AAKO,MAAMA,qBAAqBC;EAChC,qBAAWC;IACT,OAAO;MACLC,MAAM;QAAEC,MAAMC;;MACdC,MAAM;QAAEF,MAAMG;;MACdC,MAAM;QAAEJ,MAAMG;;MACdE,aAAa;QAAEL,MAAMG;;MACrBG,aAAa;QAAEN,MAAMG;;MACrBI,KAAK;QAAEP,MAAMG;;;AAEhB;EAED,iBAAWK;IACT,OAAO,EAACC,oBAAoBC;AAC7B;EAED,WAAAC;IACEC,SACAC,KAAKC,mBACLD,KAAKE,cAAc;AACpB;EAED,eAAAD;IACED,KAAKX,OAAO,IACZW,KAAKT,OAAO,IACZS,KAAKR,cAAc,IACnBQ,KAAKP,cAAc,IACnBO,KAAKN,MAAM;AACZ;EAED,iBAAAS;IACEJ,MAAMI,qBACNH,KAAKI,iBACLJ,KAAKK;AACN;EAED,oBAAAC;IACEP,MAAMO,wBACFN,KAAKE,eACPK,aAAaP,KAAKE;AAErB;EAED,cAAAG;IACE,MAAMG,MAAM,IAAIC,MACVC,QAAkC,OAAzB,KAAKF,IAAIG,gBAAuBH,IAAII;IACnDZ,KAAKE,cAAcW,YAAW;MAC5Bb,KAAKI,iBACLJ,KAAKK;AAAgB,QACpBK;AACJ;EAED,aAAAN;IACE,MAAMI,MAAM,IAAIC;IAChBT,KAAKc,eAAeN,MACpBR,KAAKe,qBACLf,KAAKgB;AACN;EAED,cAAAF,CAAeN;IACbR,KAAKX,OAAOmB,IAAIS,mBAAmB,SAAS;MAC1CC,SAAS;MACTC,OAAO;MACPC,KAAK;QAGPpB,KAAKT,OAAOiB,IACTa,mBAAmB,SAAS;MAC3BC,MAAM;MACNC,QAAQ;MACRC,SAAQ;OAETC,QAAQ,YAAY;AACxB;EAED,iBAAAV;IACE,KAAKf,KAAKd,MAAM;IAEhB,MAAMwC,gBAAgB1B,KAAKd,KAAKyC,OAAO,6BACjCC,YAAY5B,KAAKd,KAAKyC,OAAO;IAE/BD,kBACF1B,KAAKR,cAAc,GAAGqC,KAAKC,MAAMJ,cAAcK,WAAWvC;IAC1DQ,KAAKP,cAAcO,KAAKgC,eAAeN,cAAcO,SAGnDL,cACF5B,KAAKN,MAAMkC,UAAUK;AAExB;EAED,cAAAD,CAAeC;IAkBb,OAjBoB;MAClB,eAAe;MACfC,QAAQ;MACRC,KAAK;MACLC,MAAM;MACNC,WAAW;MACX,mBAAmB;MACnBC,cAAc;MACdC,SAAS;MACTC,OAAO;MACPC,OAAO;MACP,eAAe;MACfC,OAAO;MACPC,OAAO;MACP,iBAAiB;MACjBC,aAAa;MAEIX,UAAU;AAC9B;EAED,WAAAY,CAAYnD;IACV,OAAIA,OAAO,KAAW,YAClBA,OAAO,MAAY,YACnBA,OAAO,MAAY,YACnBA,OAAO,MAAY,YACnBA,OAAO,MAAY,YAChB;AACR;EAED,MAAAoD;IACE,OAAOC,IAAI;;;;;;;8BAOe/C,KAAKX;8BACLW,KAAKT;;;;;mFAKgDS,KAClEP;;;;wCAIuBO,KAAKR;;sDAESQ,KAAK6C,YAAYG,SAAShD,KAAKN;cACvEM,KAAKN;;;;;AAKhB;;;AAGHuD,eAAeC,OAAO,iBAAiBnE;;"}